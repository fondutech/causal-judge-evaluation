<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
  "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="860pt" height="280pt" viewBox="0 0 860 280" xmlns="http://www.w3.org/2000/svg" version="1.1">
 <metadata>
  <rdf:RDF xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
   <cc:Work>
    <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/>
    <dc:date>2025-05-22T04:37:27.900301</dc:date>
    <dc:format>image/svg+xml</dc:format>
    <dc:creator>
     <cc:Agent>
      <dc:title>Matplotlib v3.6.3, https://matplotlib.org/</dc:title>
     </cc:Agent>
    </dc:creator>
   </cc:Work>
  </rdf:RDF>
 </metadata>
 <defs>
  <style type="text/css">*{stroke-linejoin: round; stroke-linecap: butt}</style>
  <marker id="arrowhead" markerWidth="10" markerHeight="7" 
   refX="9" refY="3.5" orient="auto">
    <polygon points="0 0, 10 3.5, 0 7" fill="#333333" />
  </marker>
  <marker id="arrowhead-blue" markerWidth="10" markerHeight="7" 
   refX="9" refY="3.5" orient="auto">
    <polygon points="0 0, 10 3.5, 0 7" fill="#2E86AB" />
  </marker>
 </defs>
 
 <!-- Background -->
 <rect width="860" height="280" fill="#ffffff"/>
 
 <!-- Stage 1: Dataset -->
 <rect x="20" y="120" width="80" height="50" rx="5" fill="#E8F4FD" stroke="#2E86AB" stroke-width="2"/>
 <text x="60" y="140" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Dataset</text>
 <text x="60" y="155" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">raw data</text>
 
 <!-- Arrow 1 -->
 <line x1="100" y1="145" x2="130" y2="145" stroke="#333333" stroke-width="2" marker-end="url(#arrowhead)"/>
 
 <!-- Stage 2: Log -->
 <rect x="140" y="120" width="80" height="50" rx="5" fill="#E8F4FD" stroke="#2E86AB" stroke-width="2"/>
 <text x="180" y="140" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Log π₀</text>
 <text x="180" y="155" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">logs.jsonl</text>
 
 <!-- Arrow 2 -->
 <line x1="220" y1="145" x2="250" y2="145" stroke="#333333" stroke-width="2" marker-end="url(#arrowhead)"/>
 
 <!-- Stage 3: Judge -->
 <rect x="260" y="120" width="80" height="50" rx="5" fill="#F0E6FF" stroke="#8E44AD" stroke-width="2"/>
 <text x="300" y="140" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Judge</text>
 <text x="300" y="155" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">*_scores.jsonl</text>
 
 <!-- Split arrows from Judge -->
 <!-- Upper path to Calibrate -->
 <line x1="340" y1="135" x2="370" y2="135" stroke="#333333" stroke-width="2"/>
 <line x1="370" y1="135" x2="370" y2="95" stroke="#333333" stroke-width="2"/>
 <line x1="370" y1="95" x2="400" y2="95" stroke="#333333" stroke-width="2" marker-end="url(#arrowhead)"/>
 
 <!-- Lower path to Train Model -->
 <line x1="340" y1="155" x2="370" y2="155" stroke="#333333" stroke-width="2"/>
 <line x1="370" y1="155" x2="370" y2="195" stroke="#333333" stroke-width="2"/>
 <line x1="370" y1="195" x2="400" y2="195" stroke="#333333" stroke-width="2" marker-end="url(#arrowhead)"/>
 
 <!-- Stage 4a: Calibrate -->
 <rect x="410" y="70" width="100" height="50" rx="5" fill="#FFE8E8" stroke="#E74C3C" stroke-width="2"/>
 <text x="460" y="90" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Calibrate</text>
 <text x="460" y="105" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">*_cal.jsonl</text>
 
 <!-- Stage 4b: Train Model -->
 <rect x="410" y="170" width="100" height="50" rx="5" fill="#E8FFE8" stroke="#27AE60" stroke-width="2"/>
 <text x="460" y="190" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Train Model</text>
 <text x="460" y="205" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">outcome_model</text>
 
 <!-- Convergence arrows to DR-CPO -->
 <line x1="510" y1="95" x2="540" y2="95" stroke="#333333" stroke-width="2"/>
 <line x1="540" y1="95" x2="540" y2="145" stroke="#333333" stroke-width="2"/>
 <line x1="540" y1="145" x2="570" y2="145" stroke="#333333" stroke-width="2" marker-end="url(#arrowhead)"/>
 
 <line x1="510" y1="195" x2="540" y2="195" stroke="#333333" stroke-width="2"/>
 <line x1="540" y1="195" x2="540" y2="145" stroke="#333333" stroke-width="2"/>
 
 <!-- Target Policy Input -->
 <rect x="550" y="40" width="100" height="40" rx="5" fill="#FFF8E1" stroke="#F39C12" stroke-width="2" stroke-dasharray="5,5"/>
 <text x="600" y="57" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Target π′</text>
 <text x="600" y="72" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">new policy</text>
 
 <!-- Arrow from Target Policy -->
 <line x1="600" y1="80" x2="600" y2="110" stroke="#F39C12" stroke-width="2" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
 
 <!-- Stage 5: DR-CPO Estimate -->
 <rect x="580" y="120" width="120" height="50" rx="5" fill="#D5E8D4" stroke="#27AE60" stroke-width="3"/>
 <text x="640" y="140" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">DR-CPO</text>
 <text x="640" y="155" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Estimate</text>
 
 <!-- Arrow to Result -->
 <line x1="700" y1="145" x2="730" y2="145" stroke="#333333" stroke-width="2" marker-end="url(#arrowhead)"/>
 
 <!-- Final Result -->
 <rect x="740" y="120" width="80" height="50" rx="5" fill="#E8F5E8" stroke="#27AE60" stroke-width="2"/>
 <text x="780" y="140" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Result</text>
 <text x="780" y="155" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">result.json</text>
 
 <!-- Key insight annotations -->
 <text x="460" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#666" font-style="italic">Judge output feeds both paths</text>
 
 <text x="180" y="190" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#2E86AB" font-weight="bold">Logging Policy π₀</text>
 <text x="180" y="205" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">(behavior policy)</text>
 
 <text x="640" y="240" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#27AE60" font-weight="bold">Doubly-Robust Estimation</text>
 <text x="640" y="255" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">Combines importance weights + outcome model</text>
 
 <!-- Importance weighting annotation -->
 <text x="470" y="145" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#8E44AD" font-style="italic">w = π′/π₀</text>
 
</svg>
